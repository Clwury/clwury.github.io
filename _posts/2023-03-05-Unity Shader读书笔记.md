---
layout: post
title: Unity Shader笔记
subtitle: 
date: 2023-03-05 16:30:00
author: ODD
header-img: "img/in-post/2023-03-05-bg.jpg"
catalog: true
tags:
    - Shader
---

### 基础篇  

#### 渲染流水线  

* 渲染流程分为3个阶段：应用阶段（Application Stage）、几何阶段（Geometry Stage）、光栅化阶段（Rasterizer Stage）  
![概念流水线](/img/in-post/2023-03-05/概念流水线.png)
**<center>概念流水线阶段</center>**
![GPU流水线](/img/in-post/2023-03-05/GPU流水线.png)
**<center>GPU的渲染流水线实现。颜色表示了不同阶段的可配置性或可编程性：绿色表示该流水线阶段是完全可编程控制的，黄色表示该流水线阶段可以配置但不是可编程的，蓝色表示该流水线阶段是由GPU固定实现的，开发者没有任何控制权。实线表示该shader必须由开发者编程实现，虚线表示该Shader是可选的</center>**

### 初级篇  

#### 基础光照  

1、在光学中使用**辐照度**来量化光，辐照度使用光源方向l和表面法线n之间的夹角余弦值(向量点积)来计算。

2、光线与物体相交会发生**散射** (只改变光线的方向，不改变光线的密度和颜色)和**吸收** (只改变光线的密度和颜色，不改变光线的方向)。光线在物体表面发生散射后有**折射(透射)**和**反射**两个方向，在光照模型中使用**漫反射**和**高光反射**来区分两种不同的方向。根据入射光线的数量和方向，通常使用**出射度**来描述出射光线的数量和方向。**辐照度**和**出射度**之间是满足线性关系的，它们之间的比值就是材质的**漫反射**和**高光反射**属性。

3、**着色**是根据材质属性(漫反射、高光放射属性等)、光源信息(方向、辐照度等)，使用等式(**光照模型**)去计算沿某个观察方向的出射度的过程。  

4、标准光照模型将光线分为4个部分：**自发光**、**高光反射**、**漫反射**、**环境光**。  

5、三种着色频率：**Flat shading(逐三角形)**、**Gouraud shading(逐顶点)**、**Phong shading(逐像素)**。

### 中级篇

#### 渲染路径
1、**前向渲染路径**、**延迟渲染路径**和~~顶点照明渲染路径~~

2、**前向渲染路径**  
**Base Pass**: Tags { "LightMode"="ForwardBase" }, 计算一个逐像素的平行光以及所有逐顶点和SH光源  
**Additional Pass**: Tags { "LightMode"="ForwardAdd" }, 计算其他影响物体的逐像素光源，每个光源执行一次Pass

3、**延迟渲染路径**  
主要包含2个Pass, 第一个Pass不进行光照计算, 通过深度缓冲计算可见片元信息存储到G缓冲区; 第二个Pass利用缓冲区中片元信息，如表面法线、视角方向、漫反射系数等进行光照计算

4、**光源**  
4种光源类型：平行光、点光源、聚光灯和面光源  
常用光源属性：位置、方向、颜色、强度及衰减  
平行光没有位置和衰减的概念，光照强度不会随着距离发生改变

5、**光照衰减**  
内部使用_LightTexture0的纹理计算光照衰减，(0,0)表示与光源位置重合的点的衰减值，(1,1)表示在光源空间中距离最远的点的衰减值。  

6、**阴影**  

